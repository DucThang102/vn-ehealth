<% include ../../header.html %>
<style>
  #app {
    overflow: scroll;
    width: 100%;
  }
</style>

<div id="app" class="container-fluid pt-2 mb-4 mt-2">
  <template v-if="total == 0">
    <b>Không có dữ liệu</b>
  </template>
  
  <template>
	    <form @submit.prevent="timKiemHoso()" class="mb-3">
	      <div class="w">
		     	<div class="box-content">
                    <div class="row mb-2">
                        <div class="col-6"><strong>Thông tin tìm kiếm:</strong></div>
                        <div class="col-3"><strong>Trạng thái:</strong></div>
                    </div>
		     	    <div class="row mb-2">
                        <div class="col-6">
                        <input v-model="ma_yte" class="form-control" placeholder="Nhập thông tin tìm kiếm"></input>
                        </div>
                        <div class="col-3">
                            <select class="form-control" id="trangThai" name="trangThai">
                                    <option value="0">--Trạng thái --</option>
                                    <option value="7">Chờ duyệt</option>
                                    <option value="10">Đã duyệt</option>
                                    <option value="125">Hết hạn truy cập</option>
                                    <option value="9">Hủy bởi quản trị</option>
                                    <option value="8">Tự hủy</option>
                                </select>
                        </div>
                        <div class="col-3">
                            <b-button variant="primary" class="search" type="submit">Tìm kiếm</b-button>
                        </div>
		     	    </div>
		        </div>
		        <div class="row mt-2">
			        <div class="col-3">
			        	<label for="input-none"><strong>Ngày đến từ:</strong></label><br/>
			        	<b-form-input  id="type-date" type="date"></b-form-input>
			        </div>
			        <div class="col-3">
			        	<label for="input-none"><strong>Đến:</strong></label><br/>
			        	<b-form-input  id="type-date" type="date"></b-form-input>
			        </div>
			        <div class="col-3">
			        	<label for="input-none"><strong>Ngày hết hạn từ:</strong></label><br/>
			        	<b-form-input  id="type-date" type="date"></b-form-input>
			        </div>
			        <div class="col-3">
			        	<label for="input-none"><strong>Đến:</strong></label><br/>
			        	<b-form-input  id="type-date" type="date"></b-form-input>
			        </div>
		        </div>
		     </div>
	      </div>
	    </form>
    <!-- <table class="table table-bordered table-width-100" v-if="total > 0"> -->
    <table class="table table-bordered table-width-100 mt-4">

      <thead>
        <tr>
          <th style="width:5%">STT</th>
          <th style="width:2%">Mã</th>
          <th style="width:12%">Người yêu cầu</th>
          <th style="width:25%">Lý do</th>
          <th style="width:7%">Ngày yêu cầu</th>
          <th style="width:10%">Ngày cấp phép</th>
          <th style="width:10%">Ngày hết hạn</th>
          <th style="width:10%">Trạng thái</th>
          <th style="width:5%">Thao tác</th>
        </tr>
      </thead>
      <tbody>
        <!-- <tr v-for="(hs, index) in items"> -->
        <tr>
          <!-- <td>{{ index + offset + 1 }}</td> -->
          <td>0001</td>
          <!-- <td>{{ hs.so_benh_an }}</td> -->
          <td>1234</td>
          <!-- <td>{{ hs.ten_benh_nhan }}</td> -->
          <td>Nguyễn Văn B</td>
          <!-- <td>{{ hs.loai_benh_an }}</td> -->
          <td>Cấp mã truy cập</td>
          <!-- <td>{{ hs.ngay_vaovien }}</td> -->
          <td>01/11/2018</td>
          <!-- <td>{{ hs.ngay_tiepnhan }}</td> -->
          <td>20/11/2018</td>
          <!-- <td>{{ hs.ngay_ravien }}</td> -->
          <td>20/11/2019</td>
          <!-- <td>{{ hs.ma_yte }}</td> -->
          <td>Hoạt động</td>
           <td>
            <button class="btn btn-small dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
			    <i class="fas fa-fw fa-tasks"></i>
			  </button>
			  <div class="dropdown-menu">
           <!-- <a :href="createURL('/html/hsba/detail/vet-trao-doi-detail/cap_ma_truy_cap_detail.html', {yeucau_id: hs.id, backURL: currentURL})"><i class="fa fa-file-o"></i></a> -->
           
                <a class="dropdown-item" href="#"><i class="fa fa-file-o"></i>Xác nhận</a>
                <a class="dropdown-item" href="#"><i class="fa fa-file-o"></i>Chỉnh sửa</a>
                <a class="dropdown-item" href="#"><i class="fa fa-file-o"></i>Xóa</a>
          </td>
        </tr>
      </tbody>
    </table>
    <b-pagination v-if="total > perPage" size="sm" v-model="currentPage" :total-rows="total" :per-page="perPage"></b-pagination>
    <!-- <label class="label">Tổng số : {{ total }} bản ghi</label> -->
    <label class="label">Tổng số : 1 bản ghi</label>

  </template>
</div>
<script>
  new Vue({
    el: "#app",
    data: {  
    	perPage: 5,
    	currentPage: null,
    	items: [],
    	total : null,
    	ma_yte : '',
    	listNoiGuiDen: ['NguyenVanA', 'NguyenVanB', 'NguyenVanC', 'NguyenVanD'],
    	listLoaiBenhAn: ['Điều trị tự nguyện - S1', 'Điều trị tự nguyện - S2', 'Điều trị tự nguyện - S3', 'Điều trị tự nguyện - S4']
    },
    
    methods: {
//	  getTotal: async function() {this.total = await this.get("/api/hsba/count_ds_hs", {trangthai: 1, ma_yte : this.ma_yte});},
//	  getItems : async function() {this.items = await this.get("/api/hsba/get_ds_hs", { trangthai: 1, start: this.offset, count: this.perPage, ma_yte : this.ma_yte });	},
	  
	  timKiemHoso : async function() {
	    this.currentPage = 1;
	    location.href = this.currentURL;
	  }
    },
    
    computed: {      
      offset() {
        return (this.currentPage - 1) * this.perPage;
	  },
	  currentURL() {
		return this.createURL("", {ma_yte: this.ma_yte, currentPage: this.currentPage})
	  }
    },
    
    watch: {
      currentPage : async function(newVal, oldVal) {
		if(oldVal){	  
		  location.href = this.currentURL;
		}
      }
    },
    
    created: async function () {
      this.currentPage = this.getParam("currentPage") || 1;
      this.ma_yte = this.getParam("ma_yte") || "";
//      await this.getTotal();
//      await this.getItems();	  
    }
  });
</script>
